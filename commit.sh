#!/bin/bash

# –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./commit.sh "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
# –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Ç–∫—Ä–æ–π—Ç–µ GitHub Desktop –∏ –Ω–∞–∂–º–∏—Ç–µ "Push origin"

cd "$(dirname "$0")"

echo "üîÑ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–º–º–∏—Ç–∞..."
echo ""

# –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
echo "üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤..."
git add -A

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
if [ -z "$(git status --porcelain)" ]; then
    echo "‚ùå –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
    echo ""
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–º–∏—Ç–æ–≤..."
    UNPUSHED=$(git log origin/main..HEAD --oneline 2>/dev/null | wc -l | tr -d ' ')
    if [ "$UNPUSHED" -gt 0 ]; then
        echo "‚úÖ –ï—Å—Ç—å $UNPUSHED –Ω–µ–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–º–∏—Ç–æ–≤"
        echo "   –û—Ç–∫—Ä–æ–π—Ç–µ GitHub Desktop –∏ –Ω–∞–∂–º–∏—Ç–µ 'Push origin'"
    else
        echo "‚úÖ –í—Å–µ –∫–æ–º–º–∏—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã"
    fi
    exit 0
fi

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–∫–æ–º–º–∏—á–µ–Ω–æ
echo ""
echo "üìã –§–∞–π–ª—ã –¥–ª—è –∫–æ–º–º–∏—Ç–∞:"
git status --short
echo ""

# –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç
if [ -z "$1" ]; then
    COMMIT_MSG="–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: $(date '+%Y-%m-%d %H:%M:%S')"
else
    COMMIT_MSG="$1"
fi

echo "üíæ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞..."
echo "   –°–æ–æ–±—â–µ–Ω–∏–µ: $COMMIT_MSG"
git commit -m "$COMMIT_MSG"

echo ""
echo "‚úÖ –ö–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω!"
echo ""
echo "üì§ –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì:"
echo "   1. –û—Ç–∫—Ä–æ–π—Ç–µ GitHub Desktop"
echo "   2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É 'Push origin' (–≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞)"
echo "   3. Render –æ–±–Ω–æ–≤–∏—Ç —Å–∞–π—Ç —á–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã"
echo ""
echo "üåê –°–∞–π—Ç: https://crypto-academy-pro.onrender.com/"

